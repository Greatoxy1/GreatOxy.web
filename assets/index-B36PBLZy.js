import{j as e,F as S,r as a,s as L,c as P}from"./vendor-Ogb7iuwI.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function h(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(t){if(t.ep)return;t.ep=!0;const r=h(t);fetch(t.href,r)}})();const C=({searchTerm:o,setSearchTerm:i,onSearch:h})=>e.jsxs("div",{className:"search",children:[e.jsx(S,{}),e.jsx("input",{type:"text",placeholder:"Search for a movie",value:o,onChange:l=>i(l.target.value)}),e.jsx("button",{onClick:h,children:"Search"}),e.jsx("button",{onClick:()=>i(""),children:"Clear"})]}),M=({movie:o,onPlayTrailer:i})=>e.jsxs("div",{className:"movie-card",children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${o.poster_path}`,alt:o.title,className:"movie-poster"}),e.jsx("h3",{children:o.title}),e.jsx("button",{onClick:i,children:"Play Trailer"})]}),T=void 0,j="https://api.themoviedb.org/3/",E={method:"GET",headers:{accept:"application/json",Authorization:`Bearer ${T}`}},I=()=>{const[o,i]=a.useState(""),[h,l]=a.useState(null),[t,r]=a.useState([]),[u,x]=a.useState(!1),[N,y]=a.useState(""),[f,g]=a.useState(!1),v=async(s="")=>{x(!0),l("");try{const c=s?`${j}search/movie?query=${encodeURIComponent(s)}`:`${j}discover/movie?sort_by=popularity.desc`,p=await fetch(c,E);if(!p.ok)throw new Error("Failed to fetch movies");const d=await p.json();r(d.results||[])}catch(c){console.error("Error fetching movies:",c),l("Failed to fetch movies. Please try again later.")}finally{x(!1)}},b=async s=>{try{const p=await(await fetch(`${j}movie/${s}/videos`,E)).json();console.log("Video API results:",p.results);const d=p.results.filter(n=>n.site==="YouTube"),w=d.find(n=>n.type==="Trailer"&&n.iso_639_1==="en")||d.find(n=>n.type==="Trailer")||d.find(n=>n.type==="Teaser")||d.find(n=>n.type==="Clip")||d[0];w?(y(`https://www.youtube.com/watch?v=${w.key}`),g(!0)):alert("No playable video found for this movie.")}catch(c){console.error("Error fetching trailer:",c)}},m=()=>{g(""),y("")};return a.useEffect(()=>{if(!f)return;const s=c=>{c.key==="Escape"&&m()};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[f]),a.useEffect(()=>{v(o)},[o]),e.jsxs("main",{children:[e.jsx("div",{className:"pattern"}),e.jsxs("div",{className:"wrapper",children:[e.jsxs("header",{children:[e.jsx("img",{src:"images.jpeg",alt:"images"}),e.jsxs("h1",{children:["Find ",e.jsx("span",{children:"Movies"})]}),e.jsx(C,{searchTerm:o,setSearchTerm:i,onSearch:()=>v(o)})]}),e.jsxs("section",{className:"movie-list",children:[e.jsx("h2",{children:"All Movies"}),u&&e.jsx("p",{children:"Loading..."}),h&&e.jsx("p",{className:"error",children:h}),t.length>0?e.jsx("ul",{children:t.map(s=>e.jsx("li",{children:e.jsx(M,{movie:s,onPlayTrailer:()=>b(s.id),fallbackImage:"no-trailer.png"})},s.id))}):!u&&e.jsx("p",{children:"No movies found."})]})]}),f&&e.jsx("div",{className:"modal-overlay show",onClick:m,children:e.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{className:"close-btn",onClick:m,children:"âœ–"}),e.jsx(L,{url:N,className:"react-player",width:"100%",height:"400px",controls:!0,playing:!0})]})})]})};P.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(I,{})}));
