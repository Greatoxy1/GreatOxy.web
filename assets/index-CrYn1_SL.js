import{j as e,F as E,r as a,s as M,c as O}from"./vendor-Ogb7iuwI.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function h(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(t){if(t.ep)return;t.ep=!0;const s=h(t);fetch(t.href,s)}})();const T=({searchTerm:o,setSearchTerm:i,onSearch:h})=>e.jsxs("div",{className:"search",children:[e.jsx(E,{}),e.jsx("input",{type:"text",placeholder:"Search for a movie",value:o,onChange:l=>i(l.target.value)}),e.jsx("button",{onClick:h,children:"Search"}),e.jsx("button",{onClick:()=>i(""),children:"Clear"})]}),C=({movie:o,onPlayTrailer:i})=>e.jsxs("div",{className:"movie-card",children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${o.poster_path}`,alt:o.title,className:"movie-poster"}),e.jsx("h3",{children:o.title}),e.jsx("button",{onClick:i,children:"Play Trailer"})]}),L="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxMTJkY2U0ODRlNDQ3NmYxMTgwMGUxMjRhMDY1NjY2NiIsIm5iZiI6MTc1MTI3ODkxOC4yNDgsInN1YiI6IjY4NjI2NTQ2ZGE3YTFkOGNiYTIyOWEyOCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Ibm1cp8D5qr2QhmdLW2-NEbOprGdwL8lh7bPZScKBlQ",j="https://api.themoviedb.org/3/",I={method:"GET",headers:{accept:"application/json",Authorization:`Bearer ${L}`}},S=()=>{const[o,i]=a.useState(""),[h,l]=a.useState(null),[t,s]=a.useState([]),[u,y]=a.useState(!1),[w,x]=a.useState(""),[f,g]=a.useState(!1),v=async(r="")=>{y(!0),l("");try{const c=r?`${j}search/movie?query=${encodeURIComponent(r)}`:`${j}discover/movie?sort_by=popularity.desc`,p=await fetch(c,I);if(!p.ok)throw new Error("Failed to fetch movies");const d=await p.json();s(d.results||[])}catch(c){console.error("Error fetching movies:",c),l("Failed to fetch movies. Please try again later.")}finally{y(!1)}},b=async r=>{try{const p=await(await fetch(`${j}movie/${r}/videos`,I)).json();console.log("Video API results:",p.results);const d=p.results.filter(n=>n.site==="YouTube"),N=d.find(n=>n.type==="Trailer"&&n.iso_639_1==="en")||d.find(n=>n.type==="Trailer")||d.find(n=>n.type==="Teaser")||d.find(n=>n.type==="Clip")||d[0];N?(x(`https://www.youtube.com/watch?v=${N.key}`),g(!0)):alert("No playable video found for this movie.")}catch(c){console.error("Error fetching trailer:",c)}},m=()=>{g(""),x("")};return a.useEffect(()=>{if(!f)return;const r=c=>{c.key==="Escape"&&m()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[f]),a.useEffect(()=>{v(o)},[o]),e.jsxs("main",{children:[e.jsx("div",{className:"pattern"}),e.jsxs("div",{className:"wrapper",children:[e.jsxs("header",{children:[e.jsx("img",{src:"images.jpeg",alt:"images"}),e.jsxs("h1",{children:["Find ",e.jsx("span",{children:"Movies"})]}),e.jsx(T,{searchTerm:o,setSearchTerm:i,onSearch:()=>v(o)})]}),e.jsxs("section",{className:"movie-list",children:[e.jsx("h2",{children:"All Movies"}),u&&e.jsx("p",{children:"Loading..."}),h&&e.jsx("p",{className:"error",children:h}),t.length>0?e.jsx("ul",{children:t.map(r=>e.jsx("li",{children:e.jsx(C,{movie:r,onPlayTrailer:()=>b(r.id),fallbackImage:"no-trailer.png"})},r.id))}):!u&&e.jsx("p",{children:"No movies found."})]})]}),f&&e.jsx("div",{className:"modal-overlay show",onClick:m,children:e.jsxs("div",{className:"modal-content",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{className:"close-btn",onClick:m,children:"âœ–"}),e.jsx(M,{url:w,className:"react-player",width:"100%",height:"400px",controls:!0,playing:!0})]})})]})};O.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(S,{})}));
